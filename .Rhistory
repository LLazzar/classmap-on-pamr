data$x=as.matrix(datar[,2:ncol(datar)])
str(data$x)
str(data$y)
pamr=pamr.train(data)
pamr
pamrcv=pamr.cv(pamr, data)
pamrcv
source("feature_code/R/VCR_pamr.R")
library(classmap)
vcrpamr=vcr.pamr.train(data,pamr, pamrfitcv=pamrcv, threshold=16)
silplot(vcrpamr)
View(sc)
View(sc)
sc=sc[sc$V1 %in% common_strings, ]
View(sc)
View(sc)
sc=read.table("sample_datasets/GSE62944/GSE60052_79tumor.7normal.normalized.log2.data.Rda.tsv")
View(sc)
View(sc)
sc[1,]
labels_sc <- rep("NORM", 87)
labels_sc[c(35, 39, 42, 46, 80:82)] <- "SCLC"
View(labels)
View(labels)
labels=rbind(labels,labels_sc)
labels=labels[,2]
labels=rbind(labels,labels_sc)
View(labels)
View(labels)
labels=read.csv("sample_datasets/GSE62944/labels.csv")
labels=labels[,2]
labels
labels=read.csv("sample_datasets/GSE62944/labels.csv")
labels=read.csv("sample_datasets/lung_subset/GSE62944/labels.csv")
labels=labels[,2]
labels=read.csv("sample_datasets/lung_subset/GSE62944/labels.csv")
labels=read.csv("sample_datasets/GSE62944/lung_subset/labels.csv")
labels=labels[,2]
labels=cbind(labels,labels_sc)
View(labels)
View(labels)
labels=read.csv("sample_datasets/GSE62944/lung_subset/labels.csv")
labels=labels[,2]
labvels
labels
labels=c(labels,labels_sc)
labels
length(labels)
View(sc)
View(sc)
sc=sc[sc$V1 %in% common_strings, ]
View(sc)
View(sc)
sc=read.table("sample_datasets/GSE62944/GSE60052_79tumor.7normal.normalized.log2.data.Rda.tsv")
View(sc)
View(sc)
length(labels)
labels_sc <- rep("NORM", 86)
labels_sc[c(35, 39, 42, 46, 80:82)] <- "SCLC"
labels=read.csv("sample_datasets/GSE62944/lung_subset/labels.csv")
labels_sc <- rep("NORM", 86)
labels_sc[c(35, 39, 42, 46, 80:82)] <- "SCLC"
labels=labels[,2]
labels=c(labels,labels_sc)
length(labels)
sc=sc[,-1]
View(sc)
View(sc)
sc=sc[sc$V1 %in% common_strings, ]
View(sc)
sc=read.table("sample_datasets/GSE62944/GSE60052_79tumor.7normal.normalized.log2.data.Rda.tsv")
sc=sc[sc$V1 %in% common_strings, ]
sc=sc[,-1]
datar=cbind(datar,sc)
dim(datar)
View(datar)
View(datar)
data=list() #pamr wants list
data$y=as.matrix(labels[,2])
data$x=as.matrix(datar[,2:ncol(datar)])
str(data$x)
data$y=as.matrix(labels)
data$x=as.matrix(datar[,2:ncol(datar)])
str(data$x)
str(data$y)
library(pamr)
pamr=pamr.train(data)
data=list() #pamr wants list
data$y=as.matrix(labels)
data$x=as.matrix(datar[,2:ncol(datar)])
data$x=as.matrix(datar[,2:ncol(datar)])
View(data)
View(data)
View(data)
View(data)
pamr=pamr.train(data)
data$y
sc=read.table("sample_datasets/GSE62944/GSE60052_79tumor.7normal.normalized.log2.data.Rda.tsv")
View(sc)
View(sc)
View(sc)
str(sc)
sc=as.numeric(sc)
sc=read.table("sample_datasets/GSE62944/GSE60052_79tumor.7normal.normalized.log2.data.Rda.tsv")
str(sc)
sc[1,]
labels_sc <- rep("NORM", 86)
labels_sc[c(35, 39, 42, 46, 80:82)] <- "SCLC"
sc=sc[sc$V1 %in% common_strings, ]
sc=sc[,-1]
sc=as.numeric(sc)
View(sc)
View(sc)
sc=as.matrix(sc[,-1])
sc=as.numeric(sc)
datar=cbind(datar,sc)
dim(datar)
labels_sc <- rep("NORM", 86)
labels_sc[c(35, 39, 42, 46, 80:82)] <- "SCLC"
labels=read.csv("sample_datasets/GSE62944/lung_subset/labels.csv")
sc=read.table("sample_datasets/GSE62944/GSE60052_79tumor.7normal.normalized.log2.data.Rda.tsv")
str(sc)
sc[1,]
labels_sc <- rep("NORM", 86)
labels_sc[c(35, 39, 42, 46, 80:82)] <- "SCLC"
common_strings <- intersect(sc[,1], datar[,1])
n_common_strings <- length(common_strings)
n_common_strings
datar <- datar[datar$X %in% common_strings, ]  #subset to common genes to see if classification still ok
sc=sc[sc$V1 %in% common_strings, ]
sc=as.matrix(sc[,-1])
sc=as.numeric(sc)
datar=cbind(datar,sc)
sc=as.numeric(sc)
dim(sc)
sc=as.matrix(sc[,-1])
sc=read.table("sample_datasets/GSE62944/GSE60052_79tumor.7normal.normalized.log2.data.Rda.tsv")
str(sc)
sc[1,]
labels_sc <- rep("NORM", 86)
labels_sc[c(35, 39, 42, 46, 80:82)] <- "SCLC"
sc=sc[sc$V1 %in% common_strings, ]
dim(sc)
sc=as.matrix(sc[,-1])
str(sc)
sc=as.numeric(sc)
str(sc)
dim(sc)
sc=read.table("sample_datasets/GSE62944/GSE60052_79tumor.7normal.normalized.log2.data.Rda.tsv")
str(sc)
sc=sc[sc$V1 %in% common_strings, ]
dim(sc)
sc=as.matrix(sc[,-1])
str(sc)
nrow=nrow(sc)
nrow
sc=as.numeric(sc)
sc<- matrix(my_matrix_numeric, nrow = nrow, byrow = TRUE)
sc<- matrix(sc, nrow = nrow, byrow = TRUE)
str(sc)
datar=cbind(datar,sc)
dim(datar)
datar=read.csv("sample_datasets/GSE62944/lung_subset/tpm_expression.csv")
datar <- datar[datar$X %in% common_strings, ]  #subset to common genes to see if classification still ok
datar=cbind(datar,sc)
dim(datar)
str(datar)
data=list() #pamr wants list
data$y=as.matrix(labels)
data$x=as.matrix(datar[,2:ncol(datar)])
str(data$x)
str(data$y)
library(pamr)
pamr=pamr.train(data)
table(data$y)
data$y
labels=read.csv("sample_datasets/GSE62944/lung_subset/labels.csv")
labels_sc <- rep("NORM", 86)
labels_sc[c(35, 39, 42, 46, 80:82)] <- "SCLC"
labels=labels[,2]
labels=c(labels,labels_sc)
labels
data=list() #pamr wants list
data$y=as.matrix(labels)
data$x=as.matrix(datar[,2:ncol(datar)])
str(data$x)
str(data$y)
table(data$y)
labels=read.csv("sample_datasets/GSE62944/lung_subset/labels.csv")
datar=read.csv("sample_datasets/GSE62944/lung_subset/tpm_expression.csv")
covariates=read.csv("sample_datasets/GSE62944/lung_subset/covariates.csv")
sc=read.table("sample_datasets/GSE62944/GSE60052_79tumor.7normal.normalized.log2.data.Rda.tsv")
str(sc)
sc[1,]
labels_sc <- rep("SC", 86)
labels_sc[c(35, 39, 42, 46, 80:82)] <- "NORM"
common_strings <- intersect(sc[,1], datar[,1])
n_common_strings <- length(common_strings)
n_common_strings
datar <- datar[datar$X %in% common_strings, ]  #subset to common genes to see if classification still ok
sc=sc[sc$V1 %in% common_strings, ]
dim(sc)
sc=as.matrix(sc[,-1])
str(sc)
nrow=nrow(sc)
nrow
sc=as.numeric(sc)
sc<- matrix(sc, nrow = nrow, byrow = TRUE)
str(sc)
datar=cbind(datar,sc)
dim(datar)
labels=labels[,2]
labels=c(labels,labels_sc)
length(labels)
data=list() #pamr wants list
data$y=as.matrix(labels)
data$x=as.matrix(datar[,2:ncol(datar)])
str(data$x)
str(data$y)
library(pamr)
pamr=pamr.train(data)
pamr
pamrcv=pamr.cv(pamr, data)
vcrpamr=vcr.pamr.train(data,pamr, pamrfitcv=pamrcv, threshold=16)
pamr
pamrcv=pamr.cv(pamr, data)
pamrcv
vcrpamr=vcr.pamr.train(data,pamr, pamrfitcv=pamrcv, threshold=20.8)
silplot(vcrpamr)
labels=read.csv("sample_datasets/GSE62944/kidney_subset/labels.csv")
datar=read.csv("sample_datasets/GSE62944/kidney_subset/tpm_expression.csv")
covariates=read.csv("sample_datasets/GSE62944/kidney_subset/covariates.csv")
View(datar)
View(datar)
View(covariates)
View(covariates)
data=list() #pamr wants list
data$y=as.matrix(labels)
data$x=as.matrix(datar[,2:ncol(datar)])
str(data$x)
str(data$y)
library(pamr)
pamr=pamr.train(data)
View(covariates)
View(labels)
View(labels)
data$y=as.matrix(labels[,2])
pamr=pamr.train(data)
pamr
pamrcv=pamr.cv(pamr, data)
pamrcv
library(classmap)
source("feature_code/R/VCR_pamr.R")
vcrpamr=vcr.pamr.train(data,pamr, pamrfitcv=pamrcv, threshold=20.4)
silplot(vcrpamr)
classmap(vcrpamr, whichclass = 1)
classmap(vcrpamr, whichclass = 2)
classmap(vcrpamr, whichclass = 3)
View(covariates)
View(covariates)
serum_calcium_level=unlist(covariates[40,2:ncol(covariates)], use.names = FALSE)
qres=qresplot(vcrpamr$PAC, serum_calcium_level, xlab = "Age (years)", opacity = 0.5,
main = "quasi residual plot for male passengers", plotLoess = TRUE)
gnder=unlist(covariates[45,2:ncol(covariates)], use.names = FALSE)
gender_coded <- ifelse(gender == "MALE", 0, 1)
gender=unlist(covariates[45,2:ncol(covariates)], use.names = FALSE)
gender_coded <- ifelse(gender == "MALE", 0, 1)
qres=qresplot(vcrpamr$PAC, gender, xlab = "Age (years)", opacity = 0.5,
main = "quasi residual plot for male passengers", plotLoess = TRUE)
gender=unlist(covariates[45,2:ncol(covariates)], use.names = FALSE)
gender_coded <- ifelse(gender == "MALE", 0, 1)
qres=qresplot(vcrpamr$PAC, gender_coded, xlab = "Age (years)", opacity = 0.5,
main = "quasi residual plot for male passengers", plotLoess = TRUE)
average_expression_level=colSums(data$x)
qres=qresplot(vcrpamr$PAC, average_expression_level, xlab = "Age (years)", opacity = 0.5,
main = "quasi residual plot for male passengers", plotLoess = TRUE)
average_expression_level
coeff=rep(NA,ncol(t(data$x)))
for (i in 1:length(coeff)) {
lm=lm(vcrpamr$PAC~t(data$x)[,i])
coeff[i]=lm$coefficients[2]
}
norm_idx <- which(labels == "NORM")
kirc_idx <- which(labels == "KIRC")
kirp_idx <- which(labels == "KIRP")
norm_ids
norm_idx
# Sample indices from each category
norm_sample <- sample(norm_idx, 100, replace = FALSE)
kirc_sample <- sample(kirc_idx, 100, replace = FALSE)
kirp_sample <- sample(kirp_idx, 100, replace = FALSE)
# Combine the samples into a single vector of indices
sample_idx <- c(norm_sample, kirc_sample, kirp_sample)
sample_idx
data$y[sample_idx]
data$y
data$y=as.matrix(labels[,2])
data$y[sample_idx]
data$y
data$y[sample_idx,]
data$y[sample_idx]
data$y
data$y[3]
data$y[c(1,2)]
sample_idx
norm_idx <- which(labels == "NORM")
kirc_idx <- which(labels == "KIRC")
kirp_idx <- which(labels == "KIRP")
# Sample indices from each category
norm_sample <- sample(norm_idx, 100, replace = FALSE)
norm_sample
norm_idx
labels
View(labels)
#SUBSAPLING
labels=labels[,2]
labels
norm_idx <- which(labels == "NORM")
norm_idx
labels=read.csv("sample_datasets/GSE62944/kidney_subset/labels.csv")
#SUBSAPLING
labels=labels[,2]
norm_idx <- which(labels == "NORM")
kirc_idx <- which(labels == "KIRC")
kirp_idx <- which(labels == "KIRP")
# Sample indices from each category
norm_sample <- sample(norm_idx, 100, replace = FALSE)
kirc_sample <- sample(kirc_idx, 100, replace = FALSE)
kirp_sample <- sample(kirp_idx, 100, replace = FALSE)
# Combine the samples into a single vector of indices
sample_idx <- c(norm_sample, kirc_sample, kirp_sample)
sample_idx
data$y[sample_idx,]
data$y=as.matrix(labels)
data$y=data$y[sample_idx,]
View(datar)
View(datar)
datar=datar[,2:ncol(datar)]
data$x=as.matrix(datar[,sample_idx])
pamr=pamr.train(data)
pamr
thres=pamr.adaptthresh(pamr)
pamr=pamr.train(data, threshold.scale = thres)
pamr=pamr.train(data)
pamr
pamrcv=pamr.cv(pamr, data)
pamrcv
vcrpamr=vcr.pamr.train(data,pamr, pamrfitcv=pamrcv, threshold=16)
silplot(vcrpamr)
classmap(vcrpamr, whichclass = 1)
classmap(vcrpamr, whichclass = 2)
classmap(vcrpamr, whichclass = 3)
classmap(vcrpamr, whichclass = 2)
vcrpamr=vcr.pamr.train(data,pamr, pamrfitcv=pamrcv, threshold=16)
classmap(vcrpamr, whichclass = 1)
classmap(vcrpamr, whichclass = 3)
classmap(vcrpamr, whichclass = 2)
classmap(vcrpamr, whichclass = 3)
classmap(vcrpamr, whichclass = 1)
classmap(vcrpamr, whichclass = 2)
classmap(vcrpamr, whichclass = 3)
silplot(vcrpamr)
clinical=read.table("sample_datasets/merged_lung_microarray/Clinicalinformation.txt")
clinical=read.csv("sample_datasets/merged_lung_microarray/Clinicalinformation.txt")
View(clinical)
View(clinical)
clinical=read.table("sample_datasets/merged_lung_microarray/Clinicalinformation.txt")
clinical=read.table("sample_datasets/merged_lung_microarray/Clinicalinformation.txt", sep = "\t", header = TRUE)
View(clinical)
View(clinical)
data=read.table("sample_datasets/merged_lung_microarray/Combat_filtered_exprs.txt", sep = "\t", header = TRUE)
data=read.table("sample_datasets/merged_lung_microarray/Combat_filtered_exprs.txt", sep = "\t", header = TRUE)
View(data)
View(data)
View(clinical)
View(clinical)
data=list() #pamr wants list
data$y=as.matrix(clinical[,8])
data$x=as.matrix(data)
datar=read.table("sample_datasets/merged_lung_microarray/Combat_filtered_exprs.txt", sep = "\t", header = TRUE)
data=list() #pamr wants list
data$y=as.matrix(clinical[,8])
data$x=as.matrix(data)
str(data$x)
data=list() #pamr wants list
data$y=as.matrix(clinical[,8])
data$x=as.matrix(datar)
str(data$x)
str(data$y)
library(pamr)
pamr=pamr.train(data)
table(data$y)
str(data$x)
View(data)
View(data)
data$x=as.matrix(datar)
pamr=pamr.train(data)
data$x
str(data$x)
View(datar)
View(datar)
data$x=as.matrix(datar)
pamr=pamr.train(data)
data$y
which(is.na(data$y))
data=list() #pamr wants list
data$y=as.matrix(clinical[1:955,8])
data$x=as.matrix(datar[,1:955])
str(data$x)
str(data$y)
pamr=pamr.train(data)
pamr
View(data)
View(data)
thres=pamr.adaptthresh(pamr)
pamr=pamr.train(data, threshold.scale = thres)
pamr
clinical=read.table("sample_datasets/merged_lung_microarray/E-MTAB-6043.sdrf", sep = "\t", header = TRUE)
clinical=read.table("sample_datasets/merged_lung_microarray/E-MTAB-6043.sdrf.txt", sep = "\t", header = TRUE)
View(clinical)
View(clinical)
datar=read.table("sample_datasets/merged_lung_microarray/Combat_filtered_exprs.txt", sep = "\t", header = TRUE)
data=list() #pamr wants list
data$y=as.matrix(clinical[,11])
table(data$y)
which(is.na(data$y))
View(datar)
View(datar)
colnames(datar)
str(clinical)
clinical_ordered <- clinical[order(match(clinical$Characteristics.GEO.sample.accession., col)),]
col=colnames(datar)
clinical_ordered <- clinical[order(match(clinical$Characteristics.GEO.sample.accession., col)),]
View(clinical_ordered)
View(clinical_ordered)
clinical[956,11]
clinical[957,11]
data$y=as.matrix(clinical[140,11])
clinical-ordered <- data.frame(clinical_ordered, row.names = NULL) #reset index
clinical_ordered <- data.frame(clinical_ordered, row.names = NULL) #reset index
View(clinical_ordered)
View(clinical_ordered)
data$y=as.matrix(clinical[956,11])
clinical_ordered[956,11]
clinical_ordered[980,11]
data=list() #pamr wants list
data$y=as.matrix(clinical_ordered[980,11])
data=list() #pamr wants list
data$y=as.matrix(clinical_ordered[,11])
data$x=as.matrix(datar[,1:955])
str(data$x)
str(data$y)
table(data$y)
library(pamr)
pamr=pamr.train(data)
pamr
table(data$y)
str(clinical_ordered)
table(data$y)
clinical_ordered <- subset(clinical_ordered, Characteristics.disease.histology. %in% c("normal histology", "squamous cell carcinoma histology", "large cell carcinoma histology", "adenocarcinoma histology"))
View(clinical_ordered)
View(clinical_ordered)
dat=datar[,clinical_ordered$Characteristics.GEO.sample.accession.]
View(dat)
View(dat)
dat[,635]
colname(dat)[845]
colname(dat)[845]
colnames(dat)[845]
clinical_ordered$Characteristics.GEO.sample.accession.[845]
data=list() #pamr wants list
data$y=as.matrix(clinical_ordered[,11])
data$x=as.matrix(dat)
pamr=pamr.train(data)
pamr
thres=pamr.adaptthresh(pamr)
pamrcv=pamr.cv(pamr, data)
pamrcv
thres=pamr.adaptthresh(pamr)
pamr=pamr.train(data, threshold.scale = thres)
clinical=read.table("sample_datasets/merged_lung_microarray/E-MTAB-6043.sdrf.txt", sep = "\t", header = TRUE)
datar=read.table("sample_datasets/merged_lung_microarray/Combat_filtered_exprs.txt", sep = "\t", header = TRUE)
col=colnames(datar)
clinical_ordered <- clinical[order(match(clinical$Characteristics.GEO.sample.accession., col)),]
clinical_ordered <- data.frame(clinical_ordered, row.names = NULL) #reset index
clinical_ordered <- subset(clinical_ordered, Characteristics.disease.histology. %in% c("normal histology", "squamous cell carcinoma histology", "large cell carcinoma histology", "adenocarcinoma histology"))
dat=datar[,clinical_ordered$Characteristics.GEO.sample.accession.]
colnames(dat)[845]
clinical_ordered$Characteristics.GEO.sample.accession.[845] #ok they matchdata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAC80lEQVR42u2Wy2sTURTG+wf4QFEwBbFKKbgQFy6SoGJFatUsXGmRbtRqE9TUmcGmSEKNpqFRtMlIjE1EsLGQKNZW+ojgVkEqiI2tuFAER0YtpMnUhtiQ9nq/hEhoJtM8uhIvHGa4c+f85pw557u3qur/oGO92rhmk4Y9rtKwPLWQSsON0+srlZobxByeYU3FoA27TaurNYyx9oAl3Nw+KFy5+17ig9/nPU+lRWdgZsHq+5owOsLSEcOAsLXeHMbassH46i17TRN6a0j0j86k/KE48T6bI67Hv8iN/lli75NI1wOJ2KhdvS8Rk3s6ddgwIm7eY5rAuyXBqrVsy06dfap3QEgEXsRJ79AccTycJRZfjJjuxAh3O0pYPpq+XnLTOU+MdHgy8y22z4m6hq4p+CgOpmaP7tDZJvtGp5P9z+PkVnCWmL0ZZ4wrSi4WMIbPfATu9Y5vydqGa5PwpQjbWH9uFdLofvQlDhhSh4gYvjCokJ20fowjvaiDwtFpuLbWzjERaeyhkSFVjKt0WNYOtg6L8CkLW7erYy2q0T8WTeGfmX3lRZZr52/+TNXUW8LwLRddU7NpUEA1dtMCwT+rBJa1/aeeCPCdB1RpWVenJyx5aXSoRsa1MsATl99KEId8IFUQPvgjiT5DoWBx6HWClDrwTi5Q7xCS8C0D5MahIKjM3HSWAl0Kgxl7IovwLRfhS2cgsgAFYZcUSzFQOZgyUMsOWe8JvyFXcgWjBC0EU04pLZoLjncStBFyJfeyHFQJplg0KF0dVf20EHtiBR3kQpeDKbYFmnMbbdJ2qvoQYqWmB6gYmGLjZ6XtkGFYzO4GlfagorRlN1wI7mnbp0SlMGxTy4p3euPVcse2N9o/GK6LyXJhBro9wUfRGzHtm7N1DfYpfGU5kWEDVmmYMyUfMZCSRv2IiJ9fTIFgbVlHjNzTGg5GNfvMYZQ3ekrfLcy3OSOLMNxjDs+wpqJDVD6Ya/p7TNSyb9KWPjKyPJ6tCOifGH8AFuwin+ZrRG0AAAAASUVORK5CYII=
data=list() #pamr wants list
data$y=as.matrix(clinical_ordered[,11])
data$x=as.matrix(dat)
str(data$x)
str(data$y)
table(data$y)
which(is.na(data$y))
library(pamr)
pamr=pamr.train(data)
thres=pamr.adaptthresh(pamr)
pamr=pamr.train(data, threshold.scale = thres)
pamrcv=pamr.cv(pamr, data)
pamrcv
source("feature_code/R/VCR_pamr.R")
library(classmap)
vcrpamr=vcr.pamr.train(data,pamr, pamrfitcv=pamrcv, threshold=1.5)
silplot(vcrpamr)
?randomForest
rf=randomForest(data$y ~ ., data = t(data$x)))
rf=randomForest(data$y ~ ., data = t(data$x))
library(randomForest)
rf=randomForest(data$y ~ ., data = t(data$x))
thres=pamr.adaptthresh(pamr)
